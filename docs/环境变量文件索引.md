# 📦 YYC³ AI Intelligent Calling - 完整环境变量文件索引

## 📂 文件结构

```
/Users/my/yyc3-ai-call/
├── .env.example                      # ✅ 通用环境变量示例（可提交）
├── .env.local.example                # ✅ 本地开发示例（可提交）
├── .env.production.example           # ✅ 生产环境示例（可提交）
├── .env.local                        # ❌ 本地开发配置（Git 忽略）
├── .env.production                   # ❌ 生产配置（Git 忽略）
│
├── docker/
│   ├── .env.docker.example           # ✅ Docker 配置示例（可提交）
│   └── .env.docker                   # ❌ Docker 配置（Git 忽略）
│
├── docs/
│   ├── 环境变量配置指南.md            # 📖 完整配置指南
│   ├── 环境变量快速参考.md            # ⚡ 快速参考卡片
│   └── 环境变量文件索引.md            # 📋 本文件
│
└── .gitignore
    # 包含以下条目
    .env
    .env.local
    .env.production
    .env.*.local
    docker/.env.*
```

---

## 📋 文件详细说明

### 1. `.env.example` - 通用环境变量示例

**目的**: 提供所有可能的环境变量参考

**内容概览**:

- ✅ 18 个配置章节
- ✅ 80+ 个配置变量
- ✅ 完整的中英文注释
- ✅ 推荐的默认值
- ✅ 可以提交到 Git

**何时使用**:

- 项目初始化时
- 开发者入门参考
- CI/CD 配置参考
- 部署文档编写

**快速查看**:

```bash
# 查看文件大小
wc -l .env.example

# 查看所有章节
grep "^# ===" .env.example

# 搜索特定配置
grep "DATABASE_" .env.example
```

---

### 2. `.env.local.example` - 本地开发配置示例

**目的**: 为本地开发提供开箱即用的配置

**包含**:

- ✅ Docker 本地服务配置
- ✅ 本地 PostgreSQL 连接
- ✅ 本地 Redis 连接
- ✅ 本地 vLLM AI 服务
- ✅ 本地虚拟邮件服务（Ethereal）
- ✅ 本地文件存储
- ✅ 开发工具配置
- ✅ 快速启动指南

**特点**:

- 所有服务配置到本地 IP (127.0.0.1)
- 简化的配置选项（仅需要的）
- 包含完整的快速开始步骤
- 包含调试技巧

**使用步骤**:

```bash
# 1. 复制到 .env.local
cp .env.local.example .env.local

# 2. 编辑（可选自定义）
vim .env.local

# 3. 启动 Docker
docker-compose up -d

# 4. 启动应用
pnpm dev

# 5. 访问应用
# http://localhost:3000
```

---

### 3. `.env.production.example` - 生产环境配置示例

**目的**: 为生产环境部署提供安全的配置参考

**内容**:

- ✅ 企业级数据库配置
- ✅ 远程 Redis 集群配置
- ✅ SSL/TLS 安全配置
- ✅ 生产级监控和日志
- ✅ 高可用性配置
- ✅ 灾难恢复配置
- ✅ 性能优化设置
- ✅ DDoS 防护和速率限制
- ✅ 完整的安全检查清单

**关键特性**:

- 生产环境安全最佳实践
- 包含完整的 HTTPS/SSL 配置
- 监控和告警集成
- 备份和恢复策略
- 多租户支持配置

**重要提醒** ⚠️:

- ❌ 不要提交 `.env.production` 到 Git
- ❌ 所有敏感信息需在密钥管理服务中管理
- ⚠️ 部署前必须完成所有安全检查

**使用步骤**:

```bash
# 1. 仅作为参考，不要直接使用
# 2. 使用密钥管理服务（AWS Secrets Manager / Azure Key Vault）
# 3. 生成强密钥
openssl rand -base64 32

# 4. 通过部署平台设置环境变量
# 5. 完成所有安全检查清单
```

---

### 4. `docker/.env.docker.example` - Docker 容器配置

**目的**: 为 Docker Compose 服务提供配置

**包含**:

- ✅ PostgreSQL 容器环境变量
- ✅ Redis 容器环境变量
- ✅ Nginx 容器环境变量
- ✅ 应用容器环境变量
- ✅ 卷和网络配置
- ✅ 日志和健康检查
- ✅ 资源限制

**配置内容**:

```dotenv
# 数据库
POSTGRES_VERSION=16-alpine
POSTGRES_USER=postgres
POSTGRES_PASSWORD=...
POSTGRES_DB=yyc3_db

# 缓存
REDIS_VERSION=7-alpine
REDIS_PASSWORD=...

# 应用
APP_PORT=3000
APP_MEMORY_LIMIT=2g

# 网络
DOCKER_NETWORK_NAME=yyc3-network
```

**使用方法**:

```bash
# 1. 复制配置
cp docker/.env.docker.example docker/.env.docker

# 2. 编辑配置
vim docker/.env.docker

# 3. 启动容器
docker-compose --env-file docker/.env.docker up -d

# 4. 验证
docker-compose ps
```

---

## 🎯 根据环境选择使用的示例文件

### 开发环境（Development）

**推荐使用**:

- ✅ `.env.local.example` → 复制为 `.env.local`
- ✅ `docker/.env.docker.example` → 复制为 `docker/.env.docker`

**特点**:

- 所有服务本地化（localhost）
- 最小化配置
- 快速启动
- 包含调试信息

**命令**:

```bash
cp .env.local.example .env.local
cp docker/.env.docker.example docker/.env.docker
docker-compose up -d
pnpm dev
```

---

### 测试环境（Testing）

**推荐使用**:

- ✅ `.env.example` 作为基础
- ✅ 根据测试需求修改

**特点**:

- 隔离的测试数据库
- 完整的功能覆盖
- 可重复的测试环境
- 清晰的日志输出

**命令**:

```bash
cp .env.example .env.test
# 编辑 .env.test，设置测试数据库
NODE_ENV=test pnpm test
```

---

### 预发布环境（Staging）

**推荐使用**:

- ✅ `.env.production.example` 作为基础
- ✅ 使用测试数据库和 API
- ✅ 启用所有监控

**特点**:

- 与生产相似的配置
- 真实的数据库
- 完整的监控
- 用户验收测试

**配置**:

```bash
cp .env.production.example .env.staging
# 编辑 .env.staging
# - 使用 staging 数据库
# - 使用 staging API Key
# - 启用监控和日志
```

---

### 生产环境（Production）

**推荐使用**:

- ✅ `.env.production.example` 仅作为参考
- ✅ 通过密钥管理服务配置
- ✅ 绝不提交敏感信息到 Git

**特点**:

- 企业级安全配置
- 高可用性设置
- 完整的监控和告警
- 灾难恢复策略

**最佳实践**:

```bash
# 1. 使用密钥管理服务
aws secretsmanager create-secret --name yyc3/prod/config

# 2. 从密钥管理服务读取
aws secretsmanager get-secret-value --secret-id yyc3/prod/config

# 3. 在部署时注入环境变量
docker run --env-file /etc/yyc3/.env.prod myapp:latest

# 4. 绝不在 Git 中提交 .env.production
grep ".env.production" .gitignore  # 验证
```

---

## 📖 相关文档导航

### 完整指南

**文件**: `docs/环境变量配置指南.md`

- 📋 详细的配置流程
- 🔍 各环境配置对比
- ✅ 配置验证检查
- 🆘 常见问题解答
- 🔐 安全最佳实践

### 快速参考

**文件**: `docs/环境变量快速参考.md`

- ⚡ 3 步快速开始
- 🔑 关键变量速查
- 🛡️ 密钥生成命令
- ✅ 快速检查清单
- 📊 环境对比表

### 本索引文件

**文件**: `docs/环境变量文件索引.md`

- 📂 文件结构导图
- 📋 详细文件说明
- 🎯 环境选择指南
- 🔗 交叉参考

---

## 🔄 工作流程示例

### 新手快速开始（5 分钟）

```bash
# 1. 进入项目
cd yyc3-ai-call

# 2. 复制本地配置
cp .env.local.example .env.local

# 3. 启动 Docker 环境
docker-compose up -d

# 4. 启动开发服务器
pnpm dev

# 5. 打开浏览器
# http://localhost:3000
```

### 开发者切换环境（10 分钟）

```bash
# 从开发切换到生产配置验证
cp .env.production.example /tmp/.env.prod.check

# 检查所有必需的密钥
grep "REPLACE_WITH_" /tmp/.env.prod.check

# 生成强密钥
JWT_SECRET=$(openssl rand -base64 32)
NEXTAUTH_SECRET=$(openssl rand -base64 32)

# 查看生成的密钥
echo "JWT_SECRET=$JWT_SECRET"
echo "NEXTAUTH_SECRET=$NEXTAUTH_SECRET"
```

### 部署到生产（需要 30 分钟准备）

```bash
# 1. 创建密钥管理服务中的密钥
aws secretsmanager create-secret --name yyc3/prod/env

# 2. 参考生产示例编写实际配置
cat .env.production.example | head -20

# 3. 通过密钥管理服务设置环境变量
# AWS: https://console.aws.amazon.com/secretsmanager/
# Azure: https://portal.azure.com/#view/Microsoft_Azure_KeyVault/

# 4. 部署时加载环境变量
docker run --env-file /etc/yyc3/.env.prod myapp:latest

# 5. 验证部署
curl https://your-app.com/api/health
```

---

## ✅ 配置检查清单

### 项目初始化

- [ ] `.env.example` 已提交到 Git
- [ ] `.env.local.example` 已提交到 Git
- [ ] `.env.production.example` 已提交到 Git
- [ ] `docker/.env.docker.example` 已提交到 Git
- [ ] `.gitignore` 包含 `.env.local` 和 `.env.production`

### 本地开发

- [ ] 已复制 `.env.local.example` 为 `.env.local`
- [ ] 已复制 `docker/.env.docker.example` 为 `docker/.env.docker`
- [ ] Docker 容器正在运行
- [ ] 数据库可连接
- [ ] Redis 可连接
- [ ] 应用可正常启动

### 生产部署前

- [ ] 生成了强随机密钥（32 字节）
- [ ] 在密钥管理服务中创建了所有敏感信息
- [ ] 配置了 SSL/TLS 证书
- [ ] 启用了监控和告警
- [ ] 启用了数据库备份
- [ ] 配置了 CORS 允许的来源
- [ ] 设置了日志级别为 info
- [ ] 验证了数据库连接使用 SSL
- [ ] 完成了所有安全检查

---

## 🚀 快速命令集

```bash
# 查看所有环境变量示例文件
find . -name ".env*.example" -type f

# 检查是否有敏感信息
grep -r "password\|secret\|key" .env.example | head -5

# 生成密钥
openssl rand -base64 32

# 验证 .env.local
test -f .env.local && echo "✓ .env.local exists"

# 加载并验证环境变量
source .env.local && echo "✓ Env loaded: NODE_ENV=$NODE_ENV"

# 查看所有已加载的环境变量
env | grep -E "DATABASE|REDIS|AI_" | sort

# Docker Compose 验证
docker-compose --env-file docker/.env.docker ps

# 检查 Git 是否会忽略 .env 文件
git check-ignore .env.local .env.production
```

---

## 📞 获得帮助

- 📖 查看完整配置指南：[环境变量配置指南.md](环境变量配置指南.md)
- ⚡ 快速查找：[环境变量快速参考.md](环境变量快速参考.md)
- 💬 GitHub Issues：[提交问题](https://github.com/YYC-Cube/yyc3-ai-call/issues)
- 🆘 Slack Channel：#help-environment

---

**版本**: 1.0.0  
**最后更新**: 2026-01-23  
**维护**: YYC³ Team  
**许可**: MIT
